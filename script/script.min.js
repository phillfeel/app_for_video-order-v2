document.addEventListener("DOMContentLoaded",(function(){const validatonLevel=13;let formats={f16x9:"rectangle16x9",f1x1:"square",f9x16:"rectangle9x16"};function changeValCountMain(item,max,min,step){const plus=item.querySelector(".plus"),minus=item.querySelector(".minus"),count=item.querySelector(".count");count.setAttribute("disabled",!0),plus.addEventListener("click",(function(){if(count.value==step&&document.querySelector(".main-counter .minus").classList.remove("disabl"),count.value<max){document.querySelector(".main-counter .minus").classList.remove("disabled"),count.value=+count.value+step;let amountSlide=document.querySelectorAll(".video-slide").length;count.value/amountSlide>=step&&(document.querySelector(".add-item-block.add-slide button").disabled=!1,document.querySelector(".main-counter").classList.remove("notice"))}count.value==max&&plus.classList.add("disabled")})),minus.addEventListener("click",(function(){let value=+count.value;if(value==max&&plus.classList.remove("disabled"),value/+document.querySelectorAll(".video-slide").length==step?min=value:min-=step,value>min){let amountSlide;count.value=value-step,value=count.value,value/document.querySelectorAll(".video-slide").length==step&&(document.querySelector(".add-item-block.add-slide button").disabled=!0,minus.classList.add("disabled"))}count.value==step&&(document.querySelector(".main-counter .minus").classList.remove("disabled"),document.querySelector(".main-counter .minus").classList.add("disabl"))}))}function changeValCountSlides(item,max,min,step){const plus=item.querySelector(".plus"),minus=item.querySelector(".minus"),count=item.querySelector(".count");count.setAttribute("disabled",!0),plus.addEventListener("click",(function(){count.value==min&&minus.classList.remove("disabled"),count.value<max&&(count.value=+count.value+step),count.value==max&&plus.classList.add("disabled")})),minus.addEventListener("click",(function(){count.value==max&&plus.classList.remove("disabled"),count.value>min&&(count.value=+count.value-step),count.value==min&&minus.classList.add("disabled")}))}function counterTouch(selector,element=""){(selector=""!=element?element:document.querySelector(`.${selector}`)).querySelector("span.minus").addEventListener("touchstart",(function(){selector.querySelector("span.minus").classList.add("orange")})),selector.querySelector("span.minus").addEventListener("touchend",(function(){selector.querySelector("span.minus").classList.remove("orange")})),selector.querySelector("span.plus").addEventListener("touchstart",(function(){selector.querySelector("span.plus").classList.add("orange")})),selector.querySelector("span.plus").addEventListener("touchend",(function(){selector.querySelector("span.plus").classList.remove("orange")}))}function uploadFile(target){target.addEventListener("change",()=>{let amount=target.files.length;if("extra-files"==target.id&&0!=amount){let comment="";switch(!0){case amount>=2&&amount<=4||amount%10>=2&&amount%10<=4:comment="изображения";break;case 1==amount||amount%10==1:comment="изображение";break;case amount>=5&&amount<=20:comment="изображений"}target.previousElementSibling.lastElementChild.textContent=target.files.length+" "+comment}else target.previousElementSibling.lastElementChild.textContent=target.files[0].name})}changeValCountMain(document.querySelector(".counter.main-counter"),40,5,5),counterTouch("main-settings"),uploadFile(document.getElementById("extra-files"));const formatVideoSelect=document.querySelector(".format-video__change_input"),formatPreview=document.createElement("div");let formatVideoZone=document.querySelector(".format-video__preview"),pickedVideoFormat=formatVideoSelect.value,nameSlider;function createPreview(zone,item,picked){let nameFormatArr=picked.split(":"),nameFormat=`f${nameFormatArr[0]}x${nameFormatArr[1]}`;item.classList=formats[nameFormat],zone.appendChild(item)}function createPreviewCustom(){const inputCustomSize=document.querySelector(".format-video__input-size"),inputHorizont=inputCustomSize.firstElementChild,inputVertical=inputCustomSize.lastElementChild,customSizeElem=document.createElement("div");customSizeElem.classList.add("format-video__preview"),customSizeElem.innerHTML='<div class="custom-size-preview"></div>',inputCustomSize.after(customSizeElem);const customSizePreview=document.querySelector(".custom-size-preview");let horizontPx,verticalPx,proportionPx,resizeVerticalPx,resizeHorizontPx;customSizePreview.style.display="none",inputHorizont.addEventListener("input",()=>{horizontPx=inputHorizont.value,""==!inputVertical.value&&(""==inputHorizont.value||""==inputVertical.value?customSizePreview.style.display="none":customSizePreview.style.display="block",proportionPx=30/verticalPx,resizeVerticalPx=proportionPx*verticalPx,resizeHorizontPx=proportionPx*horizontPx,customSizePreview.style.width=`${resizeHorizontPx}px`,customSizePreview.style.height=`${resizeVerticalPx}px`,customSizePreview.style.border="1px solid #febf00")}),inputVertical.addEventListener("input",()=>{verticalPx=inputVertical.value,""==!inputHorizont.value&&(""==inputHorizont.value||""==inputVertical.value?customSizePreview.style.display="none":customSizePreview.style.display="block",proportionPx=30/verticalPx,resizeVerticalPx=proportionPx*verticalPx,resizeHorizontPx=proportionPx*horizontPx,customSizePreview.style.width=`${resizeHorizontPx}px`,customSizePreview.style.height=`${resizeVerticalPx}px`,customSizePreview.style.border="1px solid #febf00")})}function deletePreviewCustom(){const formatVideoZone2=document.querySelector(".format-video__preview");formatVideoZone2.remove()}function turnForm(elem){const moreColorsCheckbox=elem.querySelector(".optional-checkbox"),moreColorsInpt=elem.querySelector(".optional-txt");moreColorsCheckbox.addEventListener("click",(function(){moreColorsCheckbox.checked?moreColorsInpt.removeAttribute("disabled",!1):moreColorsInpt.setAttribute("disabled",!0)}))}function initSlideVideo(slide){var allVideos=slide.querySelectorAll(".slick-slider .slick-list .sl_slice video");allVideos.forEach(video=>video.pause()),slide.querySelector(".slick-slider .slick-list .slick-current video").play();var mutationCount=0,observer=new MutationObserver((function(mutations){if(0===mutationCount){let currentVideo=slide.querySelector(".slick-slider .slick-list .slick-current video");if(null==currentVideo)return;allVideos.forEach(video=>{video.currentTime=0,video.pause()}),currentVideo.currentTime=0,currentVideo.play(),mutationCount++}else mutationCount=0})),config={attributes:!0,childList:!1,characterData:!1},forObserve=slide.querySelector(".slick-slider .slick-list .slick-track");observer.observe(forObserve,config)}function setSlideHtmlWithSelector(number,selector){let logo="",stimulPhrs="",productPrice="",serviceDescription="",stock="",contacts="",forConstruct;switch(selector){case"logo":logo="selected";break;case"stimul":stimulPhrs="selected";break;case"product":productPrice="selected";break;case"service":serviceDescription="selected";break;case"stock":stock="selected";break;case"contact":contacts="selected"}return`<div class="wrapper"><div class="title-line"><div class="left-title"><h5 class="video-slide__number">${number}</h5><select name="slide-${number}" class="video-slide__change form-control form-control-sm"><option value="stimul" ${stimulPhrs}>Побуждающая фраза</option><option value="logo" ${logo}>Интро (вступление)</option><option value="product" ${productPrice}>Товар-Цена</option><option value="service" ${serviceDescription}>Услуга-Описание</option><option value="stock" ${stock}>Акция</option><option value="contact" ${contacts}>Контакты</option></select></div><div class="right-title"><h6 class="duration-title">Длительность</h6><div class="counter qty slide-counter"><span class="minus"><i class="fas fa-minus-circle"></i></span><input type="number" class="count" name="qty" value="5" disabled="true"><span class="plus"><i class="fas fa-plus-circle"></i></span></div></div></div></div>`}function createSecondPartHtml(nameForInitSlider){let textZoneHtml_1='<div class="text-zone">\n    <p class="title">Вы можете начать видеоролик с вопроса или фразы призывающей к покупке</p>   \n    <input class="text-field form-control" type="text" name="stimul-text" placeholder="Введите текст">\n     </div>',textZoneHtml_2='<div class="text-zone">\n     <div class="solo-check form-check">\n       <input class="form-check-input optional-checkbox" type="checkbox" value="" id="defaultCheck1">\n       <label class="form-check-label" for="defaultCheck1">\n       <input disabled name="optional-text" class="optional-txt form-control form-control-sm" type="text" placeholder="Добавить слоган или фразу">\n       </label>\n     </div>\n   </div>',textForContact='<div class="option-contact solo-check form-check">\n   <input class="form-check-input optional-checkbox" type="checkbox" value="" id="defaultCheck1">\n   <label class="form-check-label" for="defaultCheck1">\n     <input name="optional-text" class="optional-txt form-control form-control-sm" type="text" placeholder="Добавить слоган или фразу" disabled="true">\n   </label>\n   </div>',textStockHtml='<div class="text-zone">\n        <textarea name="stock-text" class="form-control text-field stock-text" id="textarea3" placeholder="Текст акции" rows="1"></textarea>\n   </div>',nameAttach,attachHtml,carouselHtml,gifName;function getCarouselHtml(gifName,nameAnim_1,nameAnim_2,nameAnim_3,nameAnim_4){let carousel;return`<h6 class="duration-title">Настроить анимацию</h6>\n      <div class="chooseAnimation-zone">\n        <div class="${nameForInitSlider}">\n          <div class="sl_slice">\n            <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n            <source src="video/${gifName}-1.webm" type='video/webm; codecs="vp8, vorbis"'>\n            <source src="video/${gifName}-1.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n            Видео не поддерживается вашим браузером</video>\n            <p class="sl_text">${nameAnim_1}</p>\n         </div>\n          <div class="sl_slice">\n            <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n            <source src="video/${gifName}-2.webm" type='video/webm; codecs="vp8, vorbis"'>\n            <source src="video/${gifName}-2.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n            Видео не поддерживается вашим браузером</video>\n            <p class="sl_text">${nameAnim_2}</p>\n         </div>\n         <div class="sl_slice">\n            <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n            <source src="video/${gifName}-3.webm" type='video/webm; codecs="vp8, vorbis"'>\n            <source src="video/${gifName}-3.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n            Видео не поддерживается вашим браузером</video>\n            <p class="sl_text">${nameAnim_3}</p>\n         </div>\n         <div class="sl_slice">\n            <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n            <source src="video/${gifName}-4.webm" type='video/webm; codecs="vp8, vorbis"'>\n            <source src="video/${gifName}-4.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n            Видео не поддерживается вашим браузером</video>\n            <p class="sl_text">${nameAnim_4}</p>\n         </div>\n         <div class="sl_slice">\n            <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n            <source src="video/${gifName}-5.webm" type='video/webm; codecs="vp8, vorbis"'>\n            <source src="video/${gifName}-5.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n            Видео не поддерживается вашим браузером</video>\n            <p class="sl_text">${nameAnim_5}</p>\n         </div>\n        </div>\n      </div>`}function getAttachHtml(name){let attach;return`<div class="attach-block for-logo">\n    <label class="my-file-input" for="exampleFormControlFile1"><p><i name="image-outline" class="far fa-image"></i>${name}</p></label>\n    <input type="file" name="example" accept="image/*" class="form-control-file" id="exampleFormControlFile1">\n    </div>`}let productZoneHtml='<div class="product-block mini-block" id="product-1">\n      <div class="form-row">\n        <div class="col-12 col-sm-8 col-md-8 col-lg-8">\n          <input name="product-1_name" type="text" class="form-control  form-control-sm" placeholder="Название товара">\n        </div>\n        <div class="col">\n          <input  name="product-1_price" type="text" class="form-control  form-control-sm" placeholder="Цена">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="col-12 col-sm-8 col-md-8 col-lg-8">\n          <input name="product-1_descript" type="text" class="form-control  description form-control-sm" placeholder="Описание товара">\n        </div>\n        <div class="col">\n          <div class="attach-block for-product">\n            <label class="my-file-input" for="product-slider-1_img-1">\n            <p>\n            <i name="image-outline" class="far fa-image"></i>\n            Изображение</p>\n            </label>\n            <input type="file" name="product-slider-1_img-1" accept="image/*" class="form-control-file" id="product-slider-1_img-1">\n          </div>\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="col">\n        <div class="delete-item">\n          <div class="close">\n          </div>\n        </div>\n      </div>\n      </div>\n    </div>\n    <div class="add-item-block inside">\n      <div class="add-item">\n        <i class="fas fa-plus-circle"></i>\n        <p>Добавить товар</p>\n      </div>\n    </div>',serviceZoneHtml='<div class="product-block service mini-block" id="service-1">\n      <div class="form-row">\n        <div class="col-12 col-sm-8 col-md-8 col-lg-8">\n          <input name="service-1_name" type="text" class="form-control  form-control-sm" placeholder="Название услуги">\n        </div>\n        <div class="col">\n          <input name="service-1_price" type="text" class="form-control  form-control-sm" placeholder="Цена">\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="col-12 col-sm-8 col-md-8 col-lg-8">\n          <input name="service-1_descript" type="text" class="form-control description form-control-sm" placeholder="Описание услуги">\n        </div>\n        <div class="col">\n          <div class="attach-block for-product">\n            <label class="my-file-input" for="service-slider-1_img-1">\n              <p>\n              <i name="image-outline" class="far fa-image"></i>\n              Изображение</p>\n            </label>\n            <input type="file" name="service-slider-1_img-1" accept="image/*" class="form-control-file" id="service-slider-1_img-1">\n          </div>\n        </div>\n      </div>\n      <div class="form-row">\n        <div class="col">\n        <div class="delete-item">\n          <div class="close">\n          </div>\n        </div>\n      </div>\n      </div>\n    </div>\n    <div class="add-item-block inside">\n      <div class="add-item">\n      <i class="fas fa-plus-circle"></i>\n        <p>Добавить услугу</p>\n      </div>\n    </div>',removeSlideHtml='<div class="btn-zone"><button type="button" class="btn-remove-slide btn btn-outline-danger btn-sm"><i class="far fa-trash-alt"></i><p>Удалить слайд</p></button></div>',insideHtml,nameAnim_1="Динамичный",nameAnim_2="Нежный",nameAnim_3="Технологичный",nameAnim_4="Брутальный",nameAnim_5="Строгий";switch(!0){case/logo-part_slider/i.test(nameForInitSlider):nameAttach="Прикрепить логотип",gifName="logo",carouselHtml=getCarouselHtml(gifName,nameAnim_1,"Нежный",nameAnim_3,nameAnim_4),insideHtml=`${textZoneHtml_2}${carouselHtml}${removeSlideHtml}`;break;case/stimul-part_slider/i.test(nameForInitSlider):gifName="stimul",carouselHtml=getCarouselHtml(gifName,nameAnim_1,"Нежный",nameAnim_3,nameAnim_4),insideHtml=`${textZoneHtml_1}${carouselHtml}${removeSlideHtml}`;break;case/product-part_slider/i.test(nameForInitSlider):gifName="product",carouselHtml=getCarouselHtml(gifName,nameAnim_1,"Нежный",nameAnim_3,nameAnim_4),insideHtml=`${productZoneHtml}${carouselHtml}${removeSlideHtml}`;break;case/service-part_slider/i.test(nameForInitSlider):gifName="service",carouselHtml=getCarouselHtml(gifName,nameAnim_1,"Нежный",nameAnim_3,nameAnim_4),insideHtml=`${serviceZoneHtml}${carouselHtml}${removeSlideHtml}`;break;case/stock-part_slider/i.test(nameForInitSlider):nameAttach="Прикрепить изображение",gifName="stock",carouselHtml=getCarouselHtml(gifName,nameAnim_1,"Нежный",nameAnim_3,nameAnim_4),attachHtml=getAttachHtml(nameAttach),insideHtml=`${attachHtml}${textStockHtml}${carouselHtml}${removeSlideHtml}`;break;case/contact-part_slider/i.test(nameForInitSlider):nameAttach="Прикрепить фото фасада",gifName="contact",carouselHtml=getCarouselHtml(gifName,nameAnim_1,"Нежный",nameAnim_3,nameAnim_4),attachHtml=getAttachHtml(nameAttach),insideHtml=`${attachHtml}${textForContact}${carouselHtml}${removeSlideHtml}`}return insideHtml}function setStimulHtmlWithSlider(name){let insideHtmlStimulPrase;return`\n    <div class="text-zone">\n    <p class="title">Вы можете начать видеоролик с вопроса или фразы призывающей к покупке</p>   \n    <input class="text-field form-control" type="text" name="stimul-text" placeholder="Введите текст">\n     </div>\n     <h6 class="duration-title">Выберите анимацию</h6>\n     <div class="chooseAnimation-zone">\n       <div class="${name}">\n         <div class="sl_slice">\n         <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n         <source src="video/stimul-1.webm" type='video/webm; codecs="vp8, vorbis"'>\n         <source src="video/stimul-1.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n         Видео не поддерживается вашим браузером</video>\n         <p class="sl_text">Динамичный</p>\n         </div>\n         <div class="sl_slice">\n         <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n         <source src="video/stimul-2.webm" type='video/webm; codecs="vp8, vorbis"'>\n         <source src="video/stimul-2.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n         Видео не поддерживается вашим браузером</video>\n         <p class="sl_text">Нежный</p>\n         </div>\n         <div class="sl_slice">\n         <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n         <source src="video/stimul-3.webm" type='video/webm; codecs="vp8, vorbis"'>\n         <source src="video/stimul-3.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n         Видео не поддерживается вашим браузером</video>\n         <p class="sl_text">Технологичный</p>\n         </div>\n         <div class="sl_slice">\n         <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n         <source src="video/stimul-4.webm" type='video/webm; codecs="vp8, vorbis"'>\n         <source src="video/stimul-4.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n         Видео не поддерживается вашим браузером</video>\n         <p class="sl_text">Брутальный</p>\n         </div> \n         <div class="sl_slice">\n         <video class="video1" muted autoplay loop crossorigin="anonymous"/>\n         <source src="video/stimul-5.webm" type='video/webm; codecs="vp8, vorbis"'>\n         <source src="video/stimul-5.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>\n         Видео не поддерживается вашим браузером</video>\n         <p class="sl_text">Строгий</p>\n         </div> \n        </div>\n        </div>\n     <div class="btn-zone"><button type="button" class="btn-remove-slide btn btn-outline-danger btn-sm"><i class="far fa-trash-alt"></i><p>Удалить слайд</p></button></div>`}function createSecondPart(wrapp,part2,classPart,funcHtmlSlider){(part2=document.createElement("div")).classList.add(classPart),part2.innerHTML=funcHtmlSlider,wrapp.appendChild(part2)}function addProduct(insideSlideWrapp,nameSlider){insideSlideWrapp.querySelector(".add-item").addEventListener("click",elem=>{let target=elem.target,allProducts=insideSlideWrapp.querySelectorAll(".product-block"),nextProduct=allProducts[allProducts.length-1].cloneNode(!0),productNumb=+nextProduct.id.split("-")[1],nextProductId=`${nextProduct.id.split("-")[0]}-${productNumb+1}`;nextProduct.id=nextProductId,uploadFile(nextProduct.querySelector('input[type="file"]')),nameSlider=nameSlider.replace(/part_/g,"");let nextProductId2=nextProductId.replace(/\w*-/gi,"");nextProduct.querySelectorAll('input[type="text"]')[0].setAttribute("name",nextProductId+"_name"),nextProduct.querySelectorAll('input[type="text"]')[1].setAttribute("name",nextProductId+"_price"),nextProduct.querySelectorAll('input[type="text"]')[2].setAttribute("name",nextProductId+"_descript");let idAttach=nameSlider+"_img-"+nextProductId2;nextProduct.querySelector('input[type="file"]').id=idAttach,nextProduct.querySelector('input[type="file"]').setAttribute("name",idAttach),nextProduct.querySelector(".my-file-input").setAttribute("for",idAttach),target.parentElement.parentElement.before(nextProduct),nextProduct.querySelectorAll("input").forEach(inpt=>{inpt.value="","file"==inpt.type&&(inpt.previousElementSibling.lastElementChild.innerHTML='<i name="image-outline" class="far fa-image"></i>Изображение')}),nextProduct.querySelector(".close").addEventListener("click",()=>{insideSlideWrapp.querySelectorAll(".product-block").length>1&&nextProduct.remove()})})}function deleteSlide(btn){1==document.querySelectorAll(".video-slide").length?document.querySelector(".btn-remove-slide").disabled=!0:document.querySelector(".btn-remove-slide").disabled=!1,btn.addEventListener("click",()=>{if(confirm("После удаления слайда данные не сохранятся. Удалить?")){const targetVideoSlide=btn.parentNode.parentNode.parentNode.parentNode;targetVideoSlide.remove();let i=1,allSlides=document.querySelectorAll(".video-slide.block"),mainCounterVal,logoCheck;document.querySelectorAll(".video-slide__number").forEach(item=>{allSlides[i-1].className=`video-slide block added-${i}`,allSlides[i-1].querySelector(".video-slide__change").setAttribute("name",`slide-${i}`),item.textContent=i++}),document.querySelector(".main-counter input").value/(i-1)<=5?(document.querySelector(".add-item-block.add-slide button").disabled=!0,document.querySelector(".main-counter .minus").classList.add("disabled")):(document.querySelector(".add-item-block.add-slide button").disabled=!1,document.querySelector(".main-counter .minus").classList.remove("disabled")),1==document.querySelectorAll(".video-slide").length?document.querySelector(".btn-remove-slide").disabled=!0:document.querySelector(".btn-remove-slide").disabled=!1,document.querySelectorAll(".form-check.for-logo").forEach(el=>{let numb=el.parentElement.parentElement.querySelector(".video-slide__number").textContent;el.querySelector('[name="logo-use"]').id="gridCheck-"+numb,el.querySelector(".for-logo label").setAttribute("for","gridCheck-"+numb)})}})}function initCarousel(carouselClass){$(carouselClass).slick({centerMode:!0,centerPadding:"60px",slidesToShow:3,slidesToScroll:2,infinity:!0,responsive:[{breakpoint:990,settings:{centerMode:!0,centerPadding:"40px",slidesToShow:2}},{breakpoint:580,settings:{centerMode:!0,centerPadding:"40px",slidesToShow:2}},{breakpoint:420,settings:{centerMode:!0,centerPadding:"40px",slidesToShow:1}}]})}function getMaxLengthStimulPhrase(slideCounterInput){return 13*+slideCounterInput.value}function validationText(element=insideSlideWrapp.querySelector(".text-zone .text-field"),elementCounter=insideSlideWrapp.querySelector(".slide-counter input")){let invalFeedback=document.createElement("div");invalFeedback.classList.add("invalid-feedback"),element.after(invalFeedback),element.addEventListener("input",e=>{let maxLengthStimulPhrase=getMaxLengthStimulPhrase(elementCounter);e.target.value.length>maxLengthStimulPhrase?(e.target.classList.add("is-invalid"),invalFeedback.textContent=`Длина текста ${e.target.value.length} при максимально допустимой в ${maxLengthStimulPhrase}`):(e.target.classList.remove("is-invalid"),invalFeedback.textContent="")})}function smoothAppearance(constructSlide){let startOpacity=.3,finishOpacity=.99,stepOp=.02;function step(){startOpacity+=.02,constructSlide.style.opacity=`${startOpacity}`,startOpacity<.99&&window.requestAnimationFrame(step)}window.requestAnimationFrame(step)}formatVideoZone&&createPreview(formatVideoZone,formatPreview,pickedVideoFormat),formatVideoSelect.addEventListener("change",()=>{if("Ввести"===formatVideoSelect.value){formatVideoZone.remove();const inputSize=document.createElement("div");inputSize.classList.add("format-video__input-size"),inputSize.innerHTML='\n        <input name="custom-format-width" class="form-control form-control-sm" type="number" placeholder="пиксели">\n        <p>X</p>\n        <input name="custom-format-height" class="form-control form-control-sm" type="number" placeholder="пиксели">',formatVideoSelect.parentNode.after(inputSize),createPreviewCustom()}else document.querySelector(".format-video__input-size")&&(document.querySelector(".format-video__input-size").remove(),deletePreviewCustom(),formatVideoZone=document.createElement("div"),formatVideoZone.classList.add("format-video__preview"),formatVideoSelect.parentNode.after(formatVideoZone)),pickedVideoFormat=formatVideoSelect.value,createPreview(formatVideoZone,formatPreview,pickedVideoFormat)}),document.querySelectorAll(".video-slide__change").forEach(item=>{let insideSlideWrapp,secondPart,optionalField;switch(item.value){case"stimul":insideSlideWrapp=item.parentNode.parentNode.parentNode,createSecondPart(insideSlideWrapp,void 0,"stimul-part",setStimulHtmlWithSlider("stimul-part_slider")),counterTouch("video-slide"),insideSlideWrapp.querySelectorAll(".solo-check").forEach((function(item){turnForm(item)})),changeValCountSlides(document.querySelector(".slide-counter"),8,2,1);let invalFeedback=document.createElement("div");invalFeedback.classList.add("invalid-feedback"),document.querySelector(".text-zone .text-field").after(invalFeedback),document.querySelector(".text-zone .text-field").addEventListener("input",e=>{let maxLengthStimulPhrase=getMaxLengthStimulPhrase(document.querySelector(".slide-counter input"));e.target.value.length>maxLengthStimulPhrase?(e.target.classList.add("is-invalid"),invalFeedback.textContent=`Длина текста ${e.target.value.length} при максимально допустимой в ${maxLengthStimulPhrase}`):(e.target.classList.remove("is-invalid"),invalFeedback.textContent="")})}initCarousel(".stimul-part_slider"),initSlideVideo(insideSlideWrapp),deleteSlide(document.querySelector(".btn-remove-slide"))});let iArr=1;function eventChangeSlide(elem){const firstPart=elem.parentElement.parentElement;let secondPart,classForSecondP;switch(firstPart.nextElementSibling.remove(),elem.value){case"logo":classForSecondP="logo-part";break;case"stimul":classForSecondP="stimul-part";break;case"product":classForSecondP="product-part";break;case"service":classForSecondP="service-part";break;case"stock":classForSecondP="stock-part";break;case"contact":classForSecondP="contact-part"}let namePart=classForSecondP,constructSlide=firstPart.parentElement.parentElement,insideSlideWrapp=firstPart.parentNode,number=+document.querySelectorAll(`.${classForSecondP}`).length+1,nameSlider=classForSecondP+"_slider-"+number;createSecondPart(firstPart.parentElement,void 0,classForSecondP,createSecondPartHtml(nameSlider));let slideNumber=+constructSlide.querySelector(".video-slide__number").textContent;if("stimul-part"===classForSecondP){let optionalField;constructSlide.querySelectorAll(".stimul-part .optional-field").forEach((function(item){createOptionalFiled(item)}))}if("stimul-part"!=classForSecondP&&"logo-part"!=classForSecondP&&uploadFile(insideSlideWrapp.querySelector(".attach-block input")),"contact-part"!==classForSecondP&&"stock-part"!==classForSecondP||(insideSlideWrapp.querySelector(".attach-block.for-logo input").id=classForSecondP+"_attach-"+number,insideSlideWrapp.querySelector(".attach-block.for-logo label").setAttribute("for",classForSecondP+"_attach-"+number),insideSlideWrapp.querySelector(".attach-block.for-logo input").setAttribute("name",classForSecondP+"_attach-"+number)),insideSlideWrapp.querySelectorAll(".solo-check").forEach((function(item){turnForm(item)})),"service-part"===classForSecondP||"product-part"===classForSecondP){if(addProduct(insideSlideWrapp,nameSlider),document.querySelectorAll(`.${classForSecondP}`).length>1){let nameSliderSlim=nameSlider.replace(/part_/g,"");insideSlideWrapp.querySelector('input[type="file"]').id=nameSliderSlim+"_img-1",insideSlideWrapp.querySelector('input[type="file"]').setAttribute("name",nameSliderSlim+"_img-1"),insideSlideWrapp.querySelector(".my-file-input").setAttribute("for",nameSliderSlim+"_img-1")}insideSlideWrapp.querySelector(".close").addEventListener("click",()=>{insideSlideWrapp.querySelectorAll(".product-block").length>=2&&(insideSlideWrapp.querySelector(".close").parentElement.parentElement,insideSlideWrapp.querySelector(".product-block").remove())})}insideSlideWrapp.querySelector(".slide-counter input").className="count "+classForSecondP+"-count-"+number,insideSlideWrapp.querySelector(".slide-counter input").setAttribute("name",classForSecondP+"-count-"+number),"stimul-part"!==namePart&&"stock-part"!==namePart||validationText(insideSlideWrapp.querySelector(".text-zone .text-field"),insideSlideWrapp.querySelector(".slide-counter input")),"logo-part"!==namePart&&"contact-part"!==namePart||validationText(insideSlideWrapp.querySelector(".solo-check .optional-txt"),insideSlideWrapp.querySelector(".slide-counter input")),"product-part"!==namePart&&"service-part"!==namePart||validationText(insideSlideWrapp.querySelector(".product-block .description"),insideSlideWrapp.querySelector(".slide-counter input")),initCarousel(`.${nameSlider}`),initSlideVideo(insideSlideWrapp),deleteSlide(insideSlideWrapp.querySelector(".btn-remove-slide")),smoothAppearance(constructSlide)}function changeSlide(elem){elem.addEventListener("change",()=>{eventChangeSlide(elem)})}function toggleClassActive(e){e.classList.toggle("active-anim")}function addClassOk(e){e.classList.add("finished-anim"),setTimeout(()=>{e.classList.remove("finished-anim"),e.classList.remove("active-anim")},4e3)}function addClassFail(e){e.classList.remove("active-anim"),e.classList.add("fail-anim"),setTimeout(()=>e.classList.remove("fail-anim"),2e3)}document.querySelector(".add-slide .add-item").addEventListener("click",()=>{let slidesArr=["stimul","logo","product","service","stock","contact"],namePart=slidesArr[iArr];iArr++,iArr==slidesArr.length&&(iArr=0);let allSlidesNumb=document.querySelectorAll(".video-slide__number"),slideNumber=+allSlidesNumb[allSlidesNumb.length-1].textContent+1,constructSlide=document.createElement("div"),main,insideSlideWrapp,secondPart;constructSlide.className=`video-slide block added-${slideNumber}`,constructSlide.innerHTML=setSlideHtmlWithSelector(slideNumber,namePart),document.querySelector(".add-slide").before(constructSlide),insideSlideWrapp=document.querySelector(`.added-${slideNumber} .wrapper`),namePart+="-part";let number=+document.querySelectorAll(`.${namePart}`).length+1,nameCarousel;if(nameCarousel=number>1?namePart+"_slider-"+number:namePart+"_slider",createSecondPart(insideSlideWrapp,void 0,namePart,createSecondPartHtml(nameCarousel)),counterTouch("",constructSlide),"logo-part"===namePart){let optionalField;document.querySelectorAll(".logo-part .optional-field").forEach((function(item){createOptionalFiled(item)}))}if("stimul-part"!=namePart&&"logo-part"!=namePart&&uploadFile(insideSlideWrapp.querySelector(".attach-block input")),"contact-part"!==namePart&&"stock-part"!==namePart||(insideSlideWrapp.querySelector(".attach-block.for-logo input").id=namePart+"_attach-"+number,insideSlideWrapp.querySelector(".attach-block.for-logo label").setAttribute("for",namePart+"_attach-"+number),insideSlideWrapp.querySelector(".attach-block.for-logo input").setAttribute("name",namePart+"_attach-"+number)),insideSlideWrapp.querySelectorAll(".solo-check").forEach((function(item){turnForm(item)})),"stimul-part"!==namePart&&"stock-part"!==namePart||validationText(insideSlideWrapp.querySelector(".text-zone .text-field"),insideSlideWrapp.querySelector(".slide-counter input")),"logo-part"!==namePart&&"contact-part"!==namePart||validationText(insideSlideWrapp.querySelector(".solo-check .optional-txt"),insideSlideWrapp.querySelector(".slide-counter input")),"product-part"!==namePart&&"service-part"!==namePart||validationText(insideSlideWrapp.querySelector(".product-block .description"),insideSlideWrapp.querySelector(".slide-counter input")),"service-part"===namePart||"product-part"===namePart){if(addProduct(insideSlideWrapp,nameCarousel),document.querySelectorAll(`.${namePart}`).length>1){let nameSliderSlim=nameCarousel.replace(/part_/g,"");insideSlideWrapp.querySelector('input[type="file"]').id=nameSliderSlim+"_img-1",insideSlideWrapp.querySelector('input[type="file"]').setAttribute("name",nameSliderSlim+"_img-1"),insideSlideWrapp.querySelector(".my-file-input").setAttribute("for",nameSliderSlim+"_img-1")}insideSlideWrapp.querySelector(".close").addEventListener("click",()=>{insideSlideWrapp.querySelectorAll(".product-block").length>=2&&(insideSlideWrapp.querySelector(".close").parentElement.parentElement,insideSlideWrapp.querySelector(".product-block").remove())})}initCarousel(`.${nameCarousel}`),initSlideVideo(insideSlideWrapp);const slideCounter=insideSlideWrapp.querySelector(".slide-counter");let mainCounterVal;slideCounter.querySelector("input").classList.add(namePart+"-count-"+number),slideCounter.querySelector("input").setAttribute("name",namePart+"-count-"+number),changeValCountSlides(slideCounter,8,2,1),changeSlide(insideSlideWrapp.querySelector(".video-slide__change")),document.querySelector(".main-counter input").value/slideNumber<=5?(document.querySelector(".add-item-block.add-slide button").disabled=!0,document.querySelector(".main-counter .minus").classList.add("disabled")):(document.querySelector(".add-item-block.add-slide button").disabled=!1,document.querySelector(".main-counter .minus").classList.remove("disabled")),deleteSlide(insideSlideWrapp.querySelector(".btn-remove-slide")),document.querySelector(".last-main-block").before(document.querySelector(".add-slide")),insideSlideWrapp.scrollIntoView(),smoothAppearance(constructSlide)}),changeSlide(document.querySelector(".video-slide__change"));let formElem=document.querySelector("#formElem");function submitHandler(e){document.querySelectorAll(".qty .count").forEach(el=>{el.removeAttribute("disabled")});let formData=new FormData(formElem);document.querySelectorAll(".slick-slider").forEach(el=>{let parentNameAnimation=el.classList[0],srcSlider,nameAnimation=el.querySelector(".slick-current img").getAttribute("src").replace(/img\//gi,"");formData.append(parentNameAnimation,nameAnimation)}),document.querySelectorAll(".qty .count").forEach(el=>{el.setAttribute("disabled","true")}),document.querySelector(".modal .modal-body").textContent="Отправляем данные... Не закрывайте окно до окончания отправки.",toggleClassActive(e),fetch("php/send.php",{method:"POST",body:formData}).then(response=>response.json()).then((function(json){addClassOk(e),document.querySelector(".modal .modal-body").textContent="Отправлено!",$(".modal").modal("show")})).catch((function(error){addClassFail(e),document.querySelector(".modal .modal-body").textContent="Отправка не удалась , попробуйте еще раз.",$(".modal").modal("show")}))}formElem.addEventListener("submit",e=>{e.preventDefault(),e=(e=e.target).querySelector('button[type="submit"]');let allDuration=document.querySelector("#main-conter-val").value,slidesDurationArr=[],slidesDuration=0;if(document.querySelectorAll(".slide-counter input").forEach(el=>{slidesDurationArr.push(el.value)}),slidesDurationArr.forEach(element=>{slidesDuration+=+element}),allDuration>=slidesDuration)document.querySelector(".duration-message")&&document.querySelector(".duration-message").remove(),submitHandler(e);else if(document.querySelector(".duration-message")){document.querySelector(".duration-message").remove();let durationMessage=document.createElement("div");durationMessage.classList.add("duration-message"),durationMessage.textContent="Сначала уменьшите длительность слайдов",document.querySelector('button[type="submit"]').before(durationMessage)}else{let durationMessage=document.createElement("div");durationMessage.classList.add("duration-message"),durationMessage.textContent="Сначала уменьшите длительность слайдов",document.querySelector('button[type="submit"]').before(durationMessage)}}),document.querySelectorAll(".nav-item .nav-link.first span").forEach(item=>{item.addEventListener("mouseover",()=>{item.parentElement.classList.add("is-current","active")}),item.addEventListener("mouseout",()=>{item.parentElement.classList.remove("is-current","active")})})}));